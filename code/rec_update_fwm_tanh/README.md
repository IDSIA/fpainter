Code taken from https://github.com/IDSIA/recurrent-fwp/tree/master/algorithmic/rec_update_fwm_tanh
